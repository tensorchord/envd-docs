name: sync doc file with envd

on: [repository_dispatch, workflow_dispatch]


jobs:
  sync_file:
    runs-on: ubuntu-latest
    steps:    
      - name: Checkout Envd-docs
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
          path: envd-docs
      - name: Checkout Envd
        uses: actions/checkout@v3
        with:
          repository: 'tensorchord/envd'
          fetch-depth: 0
          path: envd
      - run: |
          ls .
          ls ..
          ls $GITHUB_WORKSPACE/envd
          ls $GITHUB_WORKSPACE/envd-docs
      - run: |
          cp $GITHUB_WORKSPACE/envd/envd/api/* $GITHUB_WORKSPACE/envd-docs/hack/api/api/
          cd $GITHUB_WORKSPACE/envd-docs/
          git add hack/api/api
          git commit -m "sync with main repo"
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v4
